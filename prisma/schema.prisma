generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
}

enum Role {
  USER
  ADMIN
  OWNER
}

// üåü ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô (‡∏ô‡∏¥‡∏™‡∏¥‡∏ï)
model User {
  id           String    @id @default(cuid())
  name         String?
  email        String    @unique
  password     String?
  image        String?
  faculty      String?   // ‡∏Ñ‡∏ì‡∏∞ (‡πÄ‡∏ä‡πà‡∏ô ‡∏ß‡∏¥‡∏®‡∏ß‡∏∞, ‡πÄ‡∏Å‡∏©‡∏ï‡∏£)
  year         Int?      // ‡∏ä‡∏±‡πâ‡∏ô‡∏õ‡∏µ
  role         Role      @default(USER)

  // ‡∏™‡πà‡∏ß‡∏ô‡∏Ç‡∏≠‡∏á Lifestyle Quiz (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏´‡∏≤‡∏£‡∏π‡∏°‡πÄ‡∏°‡∏ó)
  cleanliness  Int?      // ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏≠‡∏≤‡∏î (1-5)
  sleepHabit   String?   // ‡πÄ‡∏ß‡∏•‡∏≤‡∏ô‡∏≠‡∏ô (Early Bird / Night Owl)
  smoking      Boolean?  // ‡∏™‡∏π‡∏ö‡∏ö‡∏∏‡∏´‡∏£‡∏µ‡πà‡πÑ‡∏´‡∏°
  
  // Relationships
  reviews      Review[]
  bookings     Booking[]
  createdAt    DateTime  @default(now())
  updatedAt    DateTime  @updatedAt
}

// üè¢ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡∏≠‡∏û‡∏±‡∏Å
model Dorm {
  id            String    @id @default(cuid())
  name          String
  description   String?
  locationShort String    // ‡πÄ‡∏ä‡πà‡∏ô "‡∏ã‡∏≠‡∏¢‡∏û‡∏´‡∏•‡πÇ‡∏¢‡∏ò‡∏¥‡∏ô 45"
  priceRange    String?   // ‡πÄ‡∏ä‡πà‡∏ô "4,500 - 6,500"
  imageUrl      String?
  rating        Float     @default(0)
  reviewCount   Int       @default(0)
  
  // ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏¢‡πà‡∏≠‡∏¢ (Scores)
  wifiScore     Float?
  securityScore Float?
  ownerScore    Float?
  
  // Relationships
  rooms         Room[]    
  reviews       Review[]
  bookings      Booking[] 
  createdAt     DateTime  @default(now())
  updatedAt     DateTime  @updatedAt
}

// üõèÔ∏è ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡πâ‡∏≠‡∏á‡∏û‡∏±‡∏Å
model Room {
  id          String    @id @default(cuid())
  name        String    // ‡πÄ‡∏ä‡πà‡∏ô "‡∏´‡πâ‡∏≠‡∏á‡πÅ‡∏≠‡∏£‡πå ‡πÄ‡∏ï‡∏µ‡∏¢‡∏á‡∏Ñ‡∏π‡πà"
  price       Int
  capacity    Int       @default(2) 
  isAvailable Boolean   @default(true) 
  
  dormId      String
  dorm        Dorm      @relation(fields: [dormId], references: [id], onDelete: Cascade)
  bookings    Booking[]
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt
}

// üí¨ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏µ‡∏ß‡∏¥‡∏ß
model Review {
  id            String   @id @default(cuid())
  rating        Int
  comment       String
  helpfulCount  Int      @default(0)
  
  userId        String
  user          User     @relation(fields: [userId], references: [id])
  dormId        String
  dorm          Dorm     @relation(fields: [dormId], references: [id])
  
  createdAt     DateTime @default(now())
}

// üìÖ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á
model Booking {
  id           String    @id @default(cuid())
  status       String    @default("PENDING") // PENDING, CONFIRMED, CANCELLED
  checkInDate  DateTime?
  
  userId       String
  user         User      @relation(fields: [userId], references: [id])
  dormId       String
  dorm         Dorm      @relation(fields: [dormId], references: [id])
  roomId       String?   
  room         Room?     @relation(fields: [roomId], references: [id])
  
  createdAt    DateTime  @default(now())
  updatedAt    DateTime  @updatedAt
}